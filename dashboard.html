<!DOCTYPE html>
<html lang="mr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ЁЯТ╕ Akash Loan App - рд╡рд╛рдкрд░рдХрд░реНрддрд╛ рдбреЕрд╢рдмреЛрд░реНрдб</title>
  <style>
    * {
      box-sizing: border-box;
      padding: 0;
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
    }

    body {
      background: linear-gradient(to right, #f0f4ff, #dbe9ff);
      padding: 1rem;
      min-height: 100vh;
      animation: fadeIn 1s ease-in-out;
    }

    header {
      background: linear-gradient(120deg, #004e92, #000428);
      color: white;
      padding: 1.5rem;
      text-align: center;
      border-radius: 20px;
      position: relative;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
      animation: slideDown 1s ease-out;
    }

    @keyframes slideDown {
      0% {
        transform: translateY(-80px);
        opacity: 0;
      }

      100% {
        transform: translateY(0);
        opacity: 1;
      }
    }

    .menu-btn {
      position: absolute;
      top: 1.2rem;
      left: 1.5rem;
      font-size: 1.8rem;
      color: white;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .menu-btn:hover {
      transform: scale(1.2);
    }

    nav {
      display: none;
      flex-direction: column;
      background: #003366;
      position: absolute;
      top: 5rem;
      left: 1rem;
      width: 220px;
      z-index: 1000;
      border-radius: 12px;
      overflow: hidden;
      animation: fadeIn 0.3s ease-in-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: scale(0.95);
      }

      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    nav a {
      padding: 1rem;
      color: white;
      text-decoration: none;
      border-bottom: 1px solid #002244;
      transition: background 0.3s, padding-left 0.3s;
    }

    nav a:hover {
      background: #0059b3;
      padding-left: 1.5rem;
    }

    .container {
      max-width: 960px;
      margin: 2rem auto;
      animation: fadeIn 1s ease;
    }

    .highlight-box {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 1.5rem;
      border-radius: 15px;
      text-align: center;
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
      animation: slideInUp 0.8s ease;
      transition: transform 0.3s ease;
    }

    .highlight-box:hover {
      transform: translateY(-5px);
    }

    .card {
      background: #ffffff;
      border-radius: 20px;
      padding: 1.5rem;
      margin-top: 1.5rem;
      box-shadow: 6px 6px 12px #cfd8dc, -6px -6px 12px #ffffff;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      animation: fadeIn 1s ease;
    }

    .card:hover {
      transform: scale(1.015);
      box-shadow: 10px 10px 20px #b0c4de;
    }

    footer {
      margin-top: 2rem;
      text-align: center;
      font-size: 0.9rem;
      color: #555;
      animation: fadeIn 2s ease-in;
    }

    .paid {
      color: #2e7d32;
      font-weight: bold;
    }

    .pending {
      color: #ef6c00;
      font-weight: bold;
    }

    .timer {
      color: #c62828;
      font-weight: bold;
      margin-top: 10px;
      animation: blink 1s infinite alternate;
    }

    @keyframes blink {
      from {
        opacity: 1;
      }

      to {
        opacity: 0.6;
      }
    }

    .installments {
      margin-top: 10px;
      padding-left: 20px;
      animation: fadeIn 0.6s ease-in;
    }

    .installments li {
      margin-bottom: 6px;
      line-height: 1.4;
    }

    #userHeader {
      margin-top: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      animation: fadeIn 0.8s ease-in-out;
    }

    #headerProfilePic {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      border: 2px solid white;
    }

    #headerUserName {
      font-size: 1.1rem;
      font-weight: 600;
      color: #fff;
    }

    iframe {
      border-radius: 10px;
      margin-top: 10px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    /* Ad section (optional enhancement) */
    #adContainer .card {
      background: linear-gradient(145deg, #fff, #e3f2fd);
      border: 2px dashed #90caf9;
    }

    #chatOptions {
      display: none;
      background: #004080;
      border-radius: 0 0 10px 10px;
      animation: fadeIn 0.4s ease;
    }

    #chatOptions a {
      padding: 12px 30px;
      font-size: 0.95rem;
      color: #fff;
      display: block;
      transition: background 0.3s ease;
    }

    #chatOptions a:hover {
      background-color: #003060;
    }

    #trendCard {
      margin-top: 1.5rem;
      padding: 1.5rem;
      width: 58%;
      margin-left: 21%;
      background: linear-gradient(145deg, #e3f2fd, #ffffff);
      border: 2px solid #64b5f6;
      border-radius: 18px;
      box-shadow: 0 8px 18px rgba(0, 0, 0, 0.15);
      transition: all 0.3s ease;
      animation: slideInUp 0.8s ease-out;
    }

    #trendCard:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 25px rgba(0, 0, 0, 0.2);
    }

    #trendCard h3 {
      text-align: center;
      color: #0d47a1;
      font-size: 1.3rem;
      margin-bottom: 1rem;
      animation: fadeIn 1s ease-in;
    }

    #trendCard canvas {
      max-height: 140px;
      width: 100%;
      background-color: #ffffff;
      padding: 10px;
      border-radius: 10px;
      box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.05);
    }

    /* Animations */
    @keyframes slideInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</head>

<body>
  <header>
    <span class="menu-btn" onclick="toggleMenu()">тШ░</span>
    <h1><b>ЁЯТ╕ Akash Loan App ЁЯТ╕</b></h1>
    <div id="userHeader">
      <img id="headerProfilePic" src="" alt="User" />
      <span id="headerUserName">User</span>
    </div>
    <select id="languageSelector" onchange="setLanguage(this.value)">
      <option value="mr">рдорд░рд╛рдареА</option>
      <option value="hi">рд╣рд┐рдВрджреА</option>
      <option value="en">English</option>
    </select>

  </header>

  <nav id="sideMenu">
    <a href="dashboard.html">ЁЯПа рдбреЕрд╢рдмреЛрд░реНрдб</a>
    <a href="profile.html">ЁЯСд рдкреНрд░реЛрдлрд╛рдИрд▓</a>
    <a href="kyc.html">ЁЯЖФ KYC</a>
    <a href="apply-loan.html">ЁЯТ╡ рдХрд░реНрдЬрд╛рд╕рд╛рдареА рдЕрд░реНрдЬ</a>
    <a href="repayment.html">тВ╣ рдкрд░рддрдлреЗрдб</a>
    <a href="faq.html">тЭУ рдкреНрд░рд╢реНрдиреЛрддреНрддрд░</a>
    <a href="loan-report.html">ЁЯУС рддреБрдордЪрд╛ рдХрд░реНрдЬ рдЕрд╣рд╡рд╛рд▓</a>

    <div style="position: relative;">
      <a href="#" onclick="toggleChatOptions()">ЁЯТм рдЖрдордЪреНрдпрд╛рд╢реА рдмреЛрд▓рд╛..!</a>
      <div id="chatOptions" style="display: none; background: #004080;">
        <a href="chatbot.html">ЁЯдЦ рдЪреЕрдЯрдмреЙрдЯ</a>
        <a href="contact.html">ЁЯУз рдЧреНрд░рд╛рд╣рдХ рд╕реЗрд╡рд╛</a>
        <a href="#" onclick="toggleLanguageOptions()">ЁЯМР рднрд╛рд╖рд╛ рдирд┐рд╡рдбрд╛</a>
        <div id="languageOptions" style="display: none; background: #002c5f;">
          <a href="#" onclick="setLanguage('mr')">рдорд░рд╛рдареА</a>
          <a href="#" onclick="setLanguage('hi')">рд╣рд┐рдВрджреА</a>
          <a href="#" onclick="setLanguage('en')">English</a>
          <a href="#" onclick="setLanguage('kn')">р▓Хр▓ир│Нр▓ир▓б</a>
          <a href="#" onclick="setLanguage('gu')">ркЧрлБркЬрк░рк╛ркдрлА</a>
        </div>
      </div>
    </div>

    <a href="admin-dashboard.html" id="adminNavLink" style="display:none">ЁЯЫбя╕П рдЕтАНреЕрдбрдорд┐рди рдкреЕрдиреЗрд▓</a>
    <a href="#" onclick="logout()">ЁЯФУ рд▓реЙрдЧрдЖрдЙрдЯ</a>
  </nav>


  <div class="container">
    <div class="highlight-box">
      <h2 id="welcomeText">рдирдорд╕реНрдХрд╛рд░, рд╡рд╛рдкрд░рдХрд░реНрддрд╛</h2>
      <p><strong>рдПрдХреВрдг рдХрд░реНрдЬ рдорд░реНрдпрд╛рджрд╛:</strong> тВ╣<span id="loanLimit">0</span></p>
    </div>
    <div class="card" id="loanCard"></div>
    <div class="card" id="emiCard"></div>
    <div id="adContainer"></div>
  </div>
  <div class="card" id="trendCard">
    <h3>ЁЯУИ Loan Trend Analysis</h3>
    <canvas id="trendChart" width="100%" height="200"></canvas>
  </div>
  <div style="text-align: center; margin-top: 10px;">
    <button onclick="loadDemoData()"
      style="padding: 10px 20px; border-radius: 8px; background: #1976d2; color: white; border: none; cursor: pointer; font-weight: bold; margin-right: 10px;">
      ЁЯФН Demo Preview
    </button>
    <button onclick="loadRealUserData()"
      style="padding: 10px 20px; border-radius: 8px; background: #388e3c; color: white; border: none; cursor: pointer; font-weight: bold;">
      ЁЯФБ Real User Data
    </button>
  </div>

  </div>
  <script>
    function loadRealUserData() {
      location.reload(); // рд╣реЗ рд╕рдЧрд│рдВ default localStorage рд╡рд░ рдЖрдзрд╛рд░рд┐рдд data рдкреБрдиреНрд╣рд╛ рд▓реЛрдб рдХрд░реЗрд▓
    }
  </script>


  </div>
  <script>
    function loadDemoData() {
      const demoUser = {
        name: "Demo User",
        email: "demo@akashloan.app",
        image: "https://cdn-icons-png.flaticon.com/512/3135/3135715.png"
      };

      const demoLoan = {
        email: demoUser.email,
        amount: 3000,
        tenure: 3,
        purpose: "Education",
        status: "Pending",
        appliedAt: new Date().toISOString()
      };

      const emi = calculateEMI(demoLoan.amount, demoLoan.tenure);
      const installments = [];
      const emiStart = new Date();

      for (let i = 1; i <= demoLoan.tenure; i++) {
        const due = new Date(emiStart);
        due.setMonth(due.getMonth() + i);
        installments.push({
          email: demoUser.email,
          label: `EMI ${i}`,
          date: due.toDateString(),
          amount: emi,
          status: i === 1 ? "Paid" : "Pending"
        });
      }

      // Do not save to localStorage тАУ just update the screen
      document.getElementById("headerUserName").textContent = demoUser.name;
      document.getElementById("headerProfilePic").src = demoUser.image;
      document.getElementById("welcomeText").textContent = `Welcome, ${demoUser.name}`;
      document.getElementById("loanLimit").textContent = 3000;

      const statusClass = demoLoan.status === 'Paid' ? 'paid' : 'pending';
      let loanHtml = `
      <h3>Your Loan Details</h3>
      <p><strong>Amount:</strong> тВ╣${demoLoan.amount}</p>
      <p><strong>Purpose:</strong> ${demoLoan.purpose}</p>
      <p><strong>Tenure:</strong> ${demoLoan.tenure} months</p>
      <p><strong>Status:</strong> <span class="${statusClass}">${demoLoan.status}</span></p>
    `;

      const dueDate = new Date();
      dueDate.setMonth(dueDate.getMonth() + demoLoan.tenure);
      const days = Math.floor((dueDate - new Date()) / (1000 * 60 * 60 * 24));
      loanHtml += `<p class="timer">тП│ ${days} Days Remaining.</p>`;
      document.getElementById("loanCard").innerHTML = loanHtml;

      let emiHtml = '<h3>ЁЯУЕ Your EMI Schedule</h3><ul class="installments">';
      installments.forEach(inst => {
        const tag = inst.status === "Paid" ? '<span class="paid">[PAID]</span>' : '<span class="pending">[PENDING]</span>';
        emiHtml += `<li><strong>${inst.label}</strong>: ${inst.date} - тВ╣${inst.amount} ${tag}</li>`;
      });
      emiHtml += '</ul>';
      document.getElementById("emiCard").innerHTML = emiHtml;

      const labels = installments.map(i => new Date(i.date).toLocaleString("default", { month: "short", year: "numeric" }));
      let cumulative = 0;
      const dataPoints = installments.map(i => {
        if (i.status === "Paid") cumulative += i.amount;
        return cumulative;
      });

      const ctx = document.getElementById("trendChart").getContext("2d");
      new Chart(ctx, {
        type: "line",
        data: {
          labels: labels,
          datasets: [{
            label: "Total EMI Paid (тВ╣)",
            data: dataPoints,
            fill: true,
            backgroundColor: "rgba(0,123,255,0.15)",
            borderColor: "#007bff",
            borderWidth: 2,
            tension: 0.4,
            pointBackgroundColor: "#007bff",
            pointRadius: 4
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { display: false }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: (val) => `тВ╣${val}`
              }
            }
          }
        }
      });
    }
  </script>


  <footer>
    &copy; 2025 Akash Loan App. All Rights Reserved.
  </footer>

  <!-- KEEP YOUR EXISTING HTML AS IS UNTIL <script> -->

  <script>
    function toggleLanguageOptions() {
      const langMenu = document.getElementById("languageOptions");
      langMenu.style.display = langMenu.style.display === "block" ? "none" : "block";
    }

    function setLanguage(lang) {
      localStorage.setItem("selectedLanguage", lang);

      const translations = {
        mr: {
          dashboard: "ЁЯПа рдбреЕрд╢рдмреЛрд░реНрдб",
          profile: "ЁЯСд рдкреНрд░реЛрдлрд╛рдИрд▓",
          kyc: "ЁЯЖФ KYC",
          applyLoan: "ЁЯТ╡ рдХрд░реНрдЬрд╛рд╕рд╛рдареА рдЕрд░реНрдЬ",
          repayment: "тВ╣ рдкрд░рддрдлреЗрдб",
          faq: "тЭУ рдкреНрд░рд╢реНрдиреЛрддреНрддрд░",
          report: "ЁЯУС рддреБрдордЪрд╛ рдХрд░реНрдЬ рдЕрд╣рд╡рд╛рд▓",
          talk: "ЁЯТм рдЖрдордЪреНрдпрд╛рд╢реА рдмреЛрд▓рд╛..!",
          chatbot: "ЁЯдЦ рдЪреЕрдЯрдмреЙрдЯ",
          contact: "ЁЯУз рдЧреНрд░рд╛рд╣рдХ рд╕реЗрд╡рд╛",
          langSelect: "ЁЯМР рднрд╛рд╖рд╛ рдирд┐рд╡рдбрд╛",
          admin: "ЁЯЫбя╕П рдЕтАНреЕрдбрдорд┐рди рдкреЕрдиреЗрд▓",
          logout: "ЁЯФУ рд▓реЙрдЧрдЖрдЙрдЯ",
          welcome: "рдирдорд╕реНрдХрд╛рд░",
          totalLoan: "рдПрдХреВрдг рдХрд░реНрдЬ рдорд░реНрдпрд╛рджрд╛:",
          noLoan: "ЁЯУн рдЖрдкрд▓реНрдпрд╛рдХрдбреЗ рд╕рдзреНрдпрд╛ рдХреЛрдгрддреЗрд╣реА рдХрд░реНрдЬ рдирд╛рд╣реА.",
          noEmi: "ЁЯз╛ EMI рдорд╛рд╣рд┐рддреА рдЙрдкрд▓рдмреНрдз рдирд╛рд╣реА.",
          loanDetails: "рддреБрдордЪреЗ рдХрд░реНрдЬ рддрдкрд╢реАрд▓",
          emiSchedule: "ЁЯУЕ рддреБрдордЪрд╛ EMI рд╢реЗрдбреНрдпреБрд▓"
        },
        hi: {
          dashboard: "ЁЯПа рдбреИрд╢рдмреЛрд░реНрдб",
          profile: "ЁЯСд рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓",
          kyc: "ЁЯЖФ KYC",
          applyLoan: "ЁЯТ╡ рдЛрдг рдХреЗ рд▓рд┐рдП рдЖрд╡реЗрджрди",
          repayment: "тВ╣ рдкреБрдирд░реНрднреБрдЧрддрд╛рди",
          faq: "тЭУ рдкреНрд░рд╢реНрдиреЛрддреНрддрд░",
          report: "ЁЯУС рдЛрдг рд░рд┐рдкреЛрд░реНрдЯ",
          talk: "ЁЯТм рд╣рдорд╕реЗ рдмрд╛рдд рдХрд░реЗрдВ..!",
          chatbot: "ЁЯдЦ рдЪреИрдЯрдмреЙрдЯ",
          contact: "ЁЯУз рдЧреНрд░рд╛рд╣рдХ рд╕реЗрд╡рд╛",
          langSelect: "ЁЯМР рднрд╛рд╖рд╛ рдЪреБрдиреЗрдВ",
          admin: "ЁЯЫбя╕П рдПрдбрдорд┐рди рдкреИрдирд▓",
          logout: "ЁЯФУ рд▓реЙрдЧрдЖрдЙрдЯ",
          welcome: "рдирдорд╕реНрддреЗ",
          totalLoan: "рдХреБрд▓ рдЛрдг рд╕реАрдорд╛:",
          noLoan: "ЁЯУн рдЖрдкрдХреЗ рдкрд╛рд╕ рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдХреЛрдИ рдЛрдг рдирд╣реАрдВ рд╣реИред",
          noEmi: "ЁЯз╛ EMI рдЬрд╛рдирдХрд╛рд░реА рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИред",
          loanDetails: "рдЖрдкрдХрд╛ рдЛрдг рд╡рд┐рд╡рд░рдг",
          emiSchedule: "ЁЯУЕ рдЖрдкрдХреА EMI рдЕрдиреБрд╕реВрдЪреА"
        },
        en: {
          dashboard: "ЁЯПа Dashboard",
          profile: "ЁЯСд Profile",
          kyc: "ЁЯЖФ KYC",
          applyLoan: "ЁЯТ╡ Apply for Loan",
          repayment: "тВ╣ Repayment",
          faq: "тЭУ FAQ",
          report: "ЁЯУС Loan Report",
          talk: "ЁЯТм Talk to Us..!",
          chatbot: "ЁЯдЦ Chatbot",
          contact: "ЁЯУз Customer Support",
          langSelect: "ЁЯМР Select Language",
          admin: "ЁЯЫбя╕П Admin Panel",
          logout: "ЁЯФУ Logout",
          welcome: "Hello",
          totalLoan: "Total Loan Limit:",
          noLoan: "ЁЯУн You currently have no loan.",
          noEmi: "ЁЯз╛ No EMI information available.",
          loanDetails: "Your Loan Details",
          emiSchedule: "ЁЯУЕ Your EMI Schedule"
        }
      };

      const t = translations[lang];
      if (!t) return;

      document.querySelector('a[href="dashboard.html"]').innerText = t.dashboard;
      document.querySelector('a[href="profile.html"]').innerText = t.profile;
      document.querySelector('a[href="kyc.html"]').innerText = t.kyc;
      document.querySelector('a[href="apply-loan.html"]').innerText = t.applyLoan;
      document.querySelector('a[href="repayment.html"]').innerText = t.repayment;
      document.querySelector('a[href="faq.html"]').innerText = t.faq;
      document.querySelector('a[href="loan-report.html"]').innerText = t.report;
      document.querySelector('#chatOptions a[href="chatbot.html"]').innerText = t.chatbot;
      document.querySelector('#chatOptions a[href="contact.html"]').innerText = t.contact;
      document.querySelector('#chatOptions a[onclick*="toggleLanguageOptions"]').innerText = t.langSelect;
      document.querySelector('a[href="admin-dashboard.html"]').innerText = t.admin;
      document.querySelector('a[onclick="logout()"]').innerText = t.logout;

      const user = JSON.parse(localStorage.getItem("loggedInUser")) || {};
      document.getElementById("welcomeText").innerText = `${t.welcome}, ${user.name || "User"}`;
      document.querySelector(".highlight-box p strong").innerText = t.totalLoan;

      // Optional: Translate if no loan
      const loanCard = document.getElementById("loanCard");
      const emiCard = document.getElementById("emiCard");

      if (loanCard && loanCard.innerHTML.includes("ЁЯУн")) {
        loanCard.innerHTML = `<p>${t.noLoan}</p>`;
      }

      if (emiCard && emiCard.innerHTML.includes("ЁЯз╛")) {
        emiCard.innerHTML = `<p>${t.noEmi}</p>`;
      }

      // Optional: Translate dynamic headings if loaded
      const loanHeading = loanCard.querySelector("h3");
      if (loanHeading) loanHeading.innerText = t.loanDetails;

      const emiHeading = emiCard.querySelector("h3");
      if (emiHeading) emiHeading.innerText = t.emiSchedule;
    }

    // Load selected language on page load
    window.addEventListener("load", () => {
      const savedLang = localStorage.getItem("selectedLanguage") || "mr";
      setLanguage(savedLang);
      document.getElementById("languageSelector").value = savedLang;
    });
  </script>


  <script>
    function toggleLanguageOptions() {
      const langMenu = document.getElementById("languageOptions");
      langMenu.style.display = langMenu.style.display === "block" ? "none" : "block";
    }



  </script>

  <script>
    function toggleMenu() {
      const sideMenu = document.getElementById("sideMenu");
      sideMenu.style.display = sideMenu.style.display === "flex" ? "none" : "flex";
    }

    function toggleChatOptions() {
      const chatMenu = document.getElementById("chatOptions");
      chatMenu.style.display = chatMenu.style.display === "block" ? "none" : "block";
    }

    function logout() {
      localStorage.removeItem("loggedInUser");
      window.location.href = "login.html";
    }

    function calculateEMI(principal, tenure, rate = 0.02) {
      if (!principal || !tenure) return 0;
      const r = rate;
      const n = tenure;
      return Math.round((principal * r * Math.pow(1 + r, n)) / (Math.pow(1 + r, n) - 1));
    }

    window.onload = () => {
      const user = JSON.parse(localStorage.getItem("loggedInUser"));
      const loans = JSON.parse(localStorage.getItem("loans")) || [];
      let installments = JSON.parse(localStorage.getItem("installments")) || [];
      const loanLimitData = JSON.parse(localStorage.getItem("loanLimitData")) || {};
      const acceptedLimitData = JSON.parse(localStorage.getItem("loanLimitAccepted")) || {};

      if (!user) {
        window.location.href = "login.html";
        return;
      }

      document.getElementById("headerUserName").textContent = user.name || "user";
      if (user.image) {
        document.getElementById("headerProfilePic").src = user.image;
      }

      document.getElementById("welcomeText").textContent = `Welcome, ${user.name || "user"}`;

      // Handle new loan limit popup
      let acceptedLimit = acceptedLimitData[user.email] || 500;
      if (loanLimitData[user.email]) {
        const newLimit = loanLimitData[user.email];
        const alreadyAccepted = acceptedLimitData[user.email] === newLimit;

        if (!alreadyAccepted) {
          const confirmBox = confirm(`ЁЯОЙ Wohoo Your Loan Limit тВ╣${newLimit} Incresed. Accept?`);
          if (confirmBox) {
            acceptedLimitData[user.email] = newLimit;
            localStorage.setItem("loanLimitAccepted", JSON.stringify(acceptedLimitData));
            acceptedLimit = newLimit;
            alert("тЬЕ New Limit Accepted.");
          } else {
            alert("тЭМ Stay With Old Limit .");
          }
        } else {
          acceptedLimit = newLimit;
        }
      }
      document.getElementById("loanLimit").textContent = acceptedLimit;

      const userLoan = loans.find(l => l.email === user.email);
      const loanCard = document.getElementById("loanCard");
      const emiCard = document.getElementById("emiCard");

      if (!userLoan) {
        loanCard.innerHTML = '<p>ЁЯУн рдЖрдкрд▓реНрдпрд╛рдХрдбреЗ рд╕рдзреНрдпрд╛ рдХреЛрдгрддреЗрд╣реА рдХрд░реНрдЬ рдирд╛рд╣реА.</p>';
        emiCard.innerHTML = '<p>ЁЯз╛ EMI рдорд╛рд╣рд┐рддреА рдЙрдкрд▓рдмреНрдз рдирд╛рд╣реА.</p>';
        installments = installments.filter(i => i.email !== user.email);
        localStorage.setItem("installments", JSON.stringify(installments));
        return;
      }

      const statusClass = userLoan.status === 'Paid' ? 'paid' : 'pending';
      let html = `
      <h3>рддреБрдордЪреЗ рдХрд░реНрдЬ рддрдкрд╢реАрд▓</h3>
      <p><strong>AMT:</strong> тВ╣${userLoan.amount}</p>
      <p><strong>Purpose:</strong> ${userLoan.purpose}</p>
      <p><strong>Tenure:</strong> ${userLoan.tenure} months</p>
      <p><strong>Status:</strong> <span class="${statusClass}">${userLoan.status}</span></p>
    `;

      const appliedAt = new Date(userLoan.appliedAt);
      const dueDate = new Date(appliedAt);
      dueDate.setMonth(dueDate.getMonth() + parseInt(userLoan.tenure));
      const now = new Date();
      const timeLeft = dueDate - now;
      if (timeLeft > 0 && userLoan.status !== 'Paid') {
        const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
        html += `<p class="timer">тП│ ${days} Days Left.</p>`;
      }
      loanCard.innerHTML = html;

      let userInstallments = installments.filter(i => i.email === user.email);
      if (!userInstallments.length) {
        const emi = calculateEMI(userLoan.amount, userLoan.tenure);
        const emiStart = new Date(userLoan.appliedAt);
        userInstallments = [];

        for (let i = 1; i <= userLoan.tenure; i++) {
          const due = new Date(emiStart);
          due.setMonth(due.getMonth() + i);
          userInstallments.push({
            email: user.email,
            label: `EMI ${i}`,
            date: due.toDateString(),
            amount: emi,
            status: "Pending"
          });
        }

        installments = [...installments, ...userInstallments];
        localStorage.setItem("installments", JSON.stringify(installments));
      }

      let emiHtml = '<h3>ЁЯУЕ Your EMI Schedule</h3><ul class="installments">';
      userInstallments.forEach(inst => {
        const tag = inst.status === "Paid" ? '<span class="paid">[PAID]</span>' : '<span class="pending">[PENDING]</span>';
        emiHtml += `<li><strong>${inst.label}</strong>: ${inst.date} - тВ╣${inst.amount} ${tag}</li>`;
      });
      emiHtml += '</ul>';
      emiCard.innerHTML = emiHtml;

      if (userLoan.status !== "Paid") {
        const allPaid = userInstallments.every(i => i.status === "Paid");
        if (allPaid) {
          const loanIndex = loans.findIndex(l => l.email === user.email);
          if (loanIndex !== -1) {
            loans[loanIndex].status = "Paid";
            localStorage.setItem("loans", JSON.stringify(loans));
          }
        }
      }

      if (user.email === "akashjadhav9136@gmail.com") {
        document.getElementById("adminNavLink").style.display = "block";
      }

      const dashboardAds = JSON.parse(localStorage.getItem("dashboardAds")) || {};
      if (dashboardAds[user?.email]) {
        const adBox = document.createElement("div");
        adBox.className = "card";
        adBox.innerHTML = `
        <h3>ЁЯУ║ Sponsered Ads</h3>
        <iframe width="100%" height="250" src="${dashboardAds[user.email]}" frameborder="0" allowfullscreen></iframe>
      `;
        document.getElementById("adContainer").appendChild(adBox);
      }

      // Loan Trend Analysis Chart
      const trendCanvas = document.getElementById("trendChart");
      if (trendCanvas && userInstallments.length > 0) {
        let cumulative = 0;
        const labels = [];
        const dataPoints = [];

        userInstallments.forEach(inst => {
          const dateObj = new Date(inst.date);
          const monthLabel = dateObj.toLocaleString("default", { month: "short", year: "numeric" });
          labels.push(monthLabel);
          if (inst.status === "Paid") cumulative += inst.amount;
          dataPoints.push(cumulative);
        });

        new Chart(trendCanvas, {
          type: "line",
          data: {
            labels: labels,
            datasets: [{
              label: "Total EMI Paid (тВ╣)",
              data: dataPoints,
              fill: true,
              backgroundColor: "rgba(0,123,255,0.15)",
              borderColor: "#007bff",
              borderWidth: 2,
              tension: 0.4,
              pointBackgroundColor: "#007bff",
              pointRadius: 4
            }]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { display: false }
            },
            scales: {
              y: {
                beginAtZero: true,
                ticks: {
                  callback: (val) => `тВ╣${val}`
                }
              }
            }
          }
        });
      }
    };


  </script>
  


</body>

</html>